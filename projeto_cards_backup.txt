=== HTML ===
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cards</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="addcard" id="addcard">
    <input type="text" placeholder="Digite algo..." />
    <i class="bi bi-plus-circle"></i>
  </div>
  <div id="cards"></div>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
  <script src="scripts.js"></script>
</body>
</html>

=== CSS ===
* {
  padding: 0;
  margin: 0;
  box-sizing: border-box;
}

body {
  display: flex;
  gap: 1.5rem;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100dvh;
  padding: 0 1rem;
  background-color: #f9f9f9;
  font-family: sans-serif;
}

.addcard {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  gap: 0.3rem;
}

.addcard input {
  width: 25%;
  padding: 0.3rem;
}

#cards {
  display: flex;
  flex-wrap: wrap;
  overflow-x: hidden;
  width: 100%;
  gap: 1rem;
}

.card {
  position: relative;
  transition: transform 0.2s ease;
}

.card.edited textarea {
  background-color: #ffe8a1;
}

.inner {
  position: relative;
  background: white;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  padding: 0.5rem;
  border-radius: 8px;
}

.card textarea {
  width: 100%;
  height: 200px;
  padding: 0.3rem;
  resize: none;
}

.card .inner i {
  position: absolute;
  opacity: 0;
  transition: opacity 0.2s ease;
  right: 0;
  transform: translate(0%, 20%);
  cursor: grab;
}

.card .inner:hover i {
  opacity: 1;
}

.bi-x-lg { top: 2%; }
.bi-pencil { top: 12%; }
.bi-copy { top: 22%; }
.bi-pin, .bi-pin-fill {
  margin-left: 0.3rem;
  position: absolute;
  bottom: 4%;
  left: 0;
  cursor: pointer;
}

=== JavaScript ===
const addCard = document.querySelector("#addcard");
const cards = document.querySelector("#cards");
const input = document.querySelector("input");
const add = document.querySelector("#addcard i");

function createCard(text = "", edited = false, isPinned = false) {
  const card = document.createElement("div");
  card.className = "card";
  if (edited) card.classList.add("edited");

  const inner = document.createElement("div");
  inner.className = "inner";

  const cardArea = document.createElement("textarea");
  cardArea.placeholder = "Digite um texto...";
  cardArea.value = text;
  cardArea.disabled = true;

  const deleteBtn = document.createElement("i");
  deleteBtn.className = "bi bi-x-lg";
  deleteBtn.addEventListener("click", () => {
    cards.removeChild(card);
    saveLocal();
  });

  const editBtn = document.createElement("i");
  editBtn.className = "bi bi-pencil";
  editBtn.addEventListener("click", () => {
    cardArea.disabled = false;
    cardArea.focus();
    cardArea.dataset.oldvalue = cardArea.value;
  });

  const copyBtn = document.createElement("i");
  copyBtn.className = "bi bi-copy";
  copyBtn.addEventListener("click", () => {
    createCard(cardArea.value);
    saveLocal();
  });

  const fixedBtn = document.createElement("i");
  fixedBtn.className = isPinned ? "bi bi-pin-fill" : "bi bi-pin";
  fixedBtn.addEventListener("click", () => {
    cards.prepend(card);
    fixedBtn.className = "bi bi-pin-fill";
    saveLocal();
  });

  cardArea.addEventListener("blur", () => {
    if (!cardArea.disabled) {
      cardArea.disabled = true;
      if (cardArea.value !== cardArea.dataset.oldvalue) {
        card.classList.add("edited");
        saveLocal();
      }
    }
  });

  inner.appendChild(cardArea);
  inner.appendChild(deleteBtn);
  inner.appendChild(editBtn);
  inner.appendChild(copyBtn);
  card.appendChild(fixedBtn);
  card.appendChild(inner);
  cards.appendChild(card);
  saveLocal();
}

add.addEventListener("click", () => {
  const text = input.value.trim();
  if (text === "") {
    alert("Digite algum texto para adicionar um card.");
    return;
  }
  createCard(text);
  input.value = "";
});

input.addEventListener("keypress", function (event) {
  if (event.key === "Enter") {
    event.preventDefault();
    const text = input.value.trim();
    if (text === "") {
      alert("Digite algum texto para adicionar um card.");
      return;
    }
    createCard(text);
    input.value = "";
  }
});

function saveLocal() {
  const allCards = document.querySelectorAll("#cards .card");
  const data = [];

  allCards.forEach((card) => {
    const text = card.querySelector("textarea").value;
    const edited = card.classList.contains("edited");
    const isPinned = card.querySelector(".bi-pin-fill") !== null;
    data.push({ text, edited, isPinned });
  });

  localStorage.setItem("notas", JSON.stringify(data));
}

window.addEventListener("DOMContentLoaded", () => {
  const saved = JSON.parse(localStorage.getItem("notas") || "[]");
  saved.forEach(({ text, edited, isPinned }) => {
    createCard(text, edited, isPinned);
  });

  Sortable.create(cards, {
    animation: 150,
    ghostClass: "sortable-ghost",
    dragClass: "sortable-drag",
  });
});